<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Kitenge Bora Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/styles.css" />

  <script src="/scripts/notifications.js" defer></script>
  <script src="/scripts/admin.js" defer></script>
</head>

<body class="admin-body">
  <audio id="kb-new-order-sound" src="/sounds/new-order.mp3" preload="auto"></audio>

  <!-- SVG SPRITE -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none;">
    <symbol id="kb-icon-lock" viewBox="0 0 24 24">
      <rect x="5" y="10" width="14" height="10" rx="2"></rect>
      <path d="M9 10V7a3 3 0 0 1 6 0v3"></path>
    </symbol>
    <symbol id="kb-icon-catalogue" viewBox="0 0 24 24">
      <rect x="4" y="5" width="16" height="14" rx="2"></rect>
      <path d="M9 5v14M15 5v14"></path>
    </symbol>
  </svg>

  <div class="shell">
    <div class="admin-card">

          <header class="admin-topbar">
      <div class="admin-topbar-left">
        <div class="admin-brand-mark">KB</div>
        <div>
          <div class="admin-topbar-title">Kitenge Bora Admin</div>
          <div class="admin-topbar-subtitle">
            Manage products, stock and promotions for your store.
          </div>
        </div>
      </div>
    </header>

      
      <!-- LOGIN -->
      <section id="login-section" class="login-section show">
        <div class="tag">
          <svg class="kb-icon"><use href="#kb-icon-lock"></use></svg>
          Admin access
        </div>

        <div class="login-layout">
          <div>
            <h1>Kitenge Bora Admin</h1>
            <p class="subtext">Manage products for the online store. Please sign in to continue.</p>
            <p class="subtext">Back to store: <a href="/">Open storefront</a></p>
          </div>

          <div id="login-alert"></div>

          <form id="login-form">
            <label for="login-email">Work email</label>
            <input id="login-email" type="email" placeholder="you@example.com" required />

            <label for="login-password">Password</label>
            <input id="login-password" type="password" required />

            <button type="submit" class="btn-primary">Sign in</button>
          </form>
        </div>
      </section>

      <!-- ADMIN DASHBOARD -->
      <section id="admin-section" class="admin-section">

        <!-- HEADER -->
        <div class="section-header">
          <div>
            <div class="tag">
              <svg class="kb-icon"><use href="#kb-icon-catalogue"></use></svg>
              Product catalogue
            </div>

            <h1>Admin Panel</h1>
            <p class="subtext">Create, edit, and archive products in PostgreSQL.</p>
          </div>

          <div class="section-header-right">
            <div id="logged-email" class="chip-email"></div>
            <div>
              <button id="logout-btn" class="btn-outline btn-small">Sign out</button>
              <button onclick="location.href='/'" class="btn-outline btn-small">View store</button>
              <button onclick="location.href='/orders.html'" class="btn-outline btn-small">View orders</button>
            </div>
          </div>
        </div>

        <!-- METRICS -->
        <div class="admin-metrics" id="admin-metrics">
          <div class="metric-card">
            <div class="metric-label">Total products</div>
            <div class="metric-value" id="metric-total-products">–</div>
            <div class="metric-sub">All items in the catalogue</div>
          </div>

          <div class="metric-card metric-warning">
            <div class="metric-label">Out of stock</div>
            <div class="metric-value" id="metric-out-of-stock">–</div>
            <div class="metric-sub">Items to restock soon</div>
          </div>

          <div class="metric-card">
            <div class="metric-label">Orders (last 50)</div>
            <div class="metric-value" id="metric-orders-count">–</div>
            <div class="metric-sub">Recent customer orders</div>
          </div>

          <div class="metric-card metric-revenue">
            <div class="metric-label">Total revenue</div>
            <div class="metric-value" id="metric-total-revenue">RWF 0</div>
            <div class="metric-sub">Subtotal + delivery (all time)</div>
          </div>
        </div>

        <div id="admin-alert"></div>

        <!-- MAIN LAYOUT: FORM + TABLE -->
        <div class="admin-main">
          <!-- LEFT: PRODUCT FORM -->
          <div class="admin-main-left">
            <div class="admin-form-card">
              <div class="admin-form-header">
                <h2 class="admin-form-title">Product details</h2>
                <p class="admin-form-hint">
                  Use “Active” to control visibility and “Promo” for discounted items.
                </p>
              </div>

              <form id="product-form">

                <div class="admin-form-section-title">Basic info</div>
                <div class="row">
                  <div>
                    <label for="name">Name *</label>
                    <input id="name" type="text" placeholder="e.g. Sunset Ankara Maxi" required />
                  </div>
                  <div>
                    <label for="category">Category</label>
                    <input id="category" type="text" placeholder="e.g. Modern, Traditional" />
                  </div>
                </div>

                <div class="admin-form-section-title">Pricing</div>
                <div class="row">
                  <div>
                    <label for="price">Price (RWF) *</label>
                    <input id="price" type="number" placeholder="e.g. 35000" />
                  </div>
                  <div>
                    <label for="original_price">Original price (promo)</label>
                    <input id="original_price" type="number" placeholder="e.g. 40000" />
                  </div>
                  <div>
                    <label for="discount">Discount (%)</label>
                    <input id="discount" type="number" placeholder="e.g. 10" />
                  </div>
                </div>

                <div class="admin-form-section-title">Images & description</div>
                <div class="row">
                  <div>
                    <label for="image-file">Image upload</label>
                    <div class="image-upload-box">
                      <input id="image-file" type="file" accept="image/*" />
                      <p class="image-upload-hint">Upload an image for this product.</p>
                    </div>

                    <div class="small-label">Image URL (auto)</div>
                    <input id="image-url" type="text" placeholder="Uploaded image URL" />
                  </div>

                  <div>
                    <label for="description">Description</label>
                    <textarea id="description" placeholder="Short description..." rows="4"></textarea>
                  </div>
                </div>

                <div class="admin-form-section-title">Status</div>
                <div class="checkbox-row">
                  <label><input id="in_stock" type="checkbox" checked /> In stock</label>
                  <label><input id="is_promo" type="checkbox" /> On promotion</label>
                  <label><input id="active" type="checkbox" checked /> Active</label>
                </div>

                <div class="form-actions">
                  <button type="submit" class="btn-primary" id="save-btn">Save product</button>
                  <button type="button" class="btn-outline" id="clear-btn">Clear form</button>
                </div>
              </form>
            </div>
          </div>

          <!-- RIGHT: PRODUCT TABLE -->
          <div class="admin-main-right">
            <div class="admin-table-card">
              <div class="panel-header">
                <div>
                  <h2 class="panel-title">All products</h2>
                  <p class="hint">Archive hides products without deleting them.</p>
                </div>

                <!-- table toolbar -->
                <div class="panel-toolbar">
                  <input
                    id="admin-search"
                    type="text"
                    placeholder="Search by name or category..."
                  />
                  <select id="admin-filter">
                    <option value="all">All</option>
                    <option value="active">Active only</option>
                    <option value="archived">Archived</option>
                    <option value="promo">Promo</option>
                    <option value="out">Out of stock</option>
                  </select>
                </div>
              </div>

              <div class="admin-table-wrapper">
                <table class="admin-table">
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Name / Category</th>
                      <th>Price</th>
                      <th>Stock</th>
                      <th>Promo / Status</th>
                      <th style="width:160px;">Actions</th>
                    </tr>
                  </thead>
                  <tbody id="products-body"></tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

      </section>
    </div>
  </div>
</body>
</html>
